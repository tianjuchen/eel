<!DOCTYPE html><head><meta charset="UTF-8"><title>RankOneDivergence | Stingray</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Stingray</a><a href="https://github.com/hugary1995/stingray" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../theory.html">Theory</a></li><li><a href="../../implementation.html">Implementation</a></li><li><a href="../../examples.html">Examples</a></li><li><a href="../../stingray.html">Documentation</a></li></ul><a href="#" class="sidenav-trigger" data-target="232766cb-8ea0-4195-912f-d10e7d72335a"><i class="material-icons">menu</i></a><ul class="sidenav" id="232766cb-8ea0-4195-912f-d10e7d72335a"><li><a href="../../theory.html">Theory</a></li><li><a href="../../implementation.html">Implementation</a></li><li><a href="../../examples.html">Examples</a></li><li><a href="../../stingray.html">Documentation</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">kernels</span><a href="#" class="breadcrumb">RankOneDivergence</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="66d29870-591e-4ac5-abb3-40f2efed4fd2" data-section-level="1" data-section-text="RankOneDivergence"><h1 id="rankonedivergence">RankOneDivergence</h1><p>This class implements the weak form for the divergence of a vector.</p><section class="scrollspy" id="4b852f50-221a-4f01-82ef-ece575566e85" data-section-level="2" data-section-text="Overview"><h2 id="overview">Overview</h2><p>Given a strong form <span class="moose-katex-inline-equation" id="moose-equation-6a55361f-6c30-4071-93a1-4ecb0e890a6e"><script>var element = document.getElementById("moose-equation-6a55361f-6c30-4071-93a1-4ecb0e890a6e");katex.render("-\\divergence \\bfv", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\diff":"\\text{ d}#1","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span>, the corresponding weak form is</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-4c733766-f288-448a-b1f4-e7edec6037e3"></span><script>var element = document.getElementById("moose-equation-4c733766-f288-448a-b1f4-e7edec6037e3");katex.render("  \\left( \\grad \\psi, \\bfv \\right)_\\Omega", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\diff":"\\text{ d}#1","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span></p><p>where <span class="moose-katex-inline-equation" id="moose-equation-7a9719c6-9027-4089-bbca-c78989cda4e1"><script>var element = document.getElementById("moose-equation-7a9719c6-9027-4089-bbca-c78989cda4e1");katex.render("\\psi", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\diff":"\\text{ d}#1","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> is the test function, and <span class="moose-katex-inline-equation" id="moose-equation-44f865a8-c8e5-414f-9a59-0cb898af8e3e"><script>var element = document.getElementById("moose-equation-44f865a8-c8e5-414f-9a59-0cb898af8e3e");katex.render("\\bfv", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\grad":"\\bs{\\nabla}","\\divergence":"\\grad \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\abs":"\\left\\lvert#1\\right\\rvert","\\diff":"\\text{ d}#1","\\bfa":"\\boldsymbol{a}","\\bfb":"\\boldsymbol{b}","\\bfc":"\\boldsymbol{c}","\\bfd":"\\boldsymbol{d}","\\bfe":"\\boldsymbol{e}","\\bff":"\\boldsymbol{f}","\\bfg":"\\boldsymbol{g}","\\bfh":"\\boldsymbol{h}","\\bfi":"\\boldsymbol{i}","\\bfj":"\\boldsymbol{j}","\\bfk":"\\boldsymbol{k}","\\bfl":"\\boldsymbol{l}","\\bfm":"\\boldsymbol{m}","\\bfn":"\\boldsymbol{n}","\\bfo":"\\boldsymbol{o}","\\bfp":"\\boldsymbol{p}","\\bfq":"\\boldsymbol{q}","\\bfr":"\\boldsymbol{r}","\\bfs":"\\boldsymbol{s}","\\bft":"\\boldsymbol{t}","\\bfu":"\\boldsymbol{u}","\\bfv":"\\boldsymbol{v}","\\bfw":"\\boldsymbol{w}","\\bfx":"\\boldsymbol{x}","\\bfy":"\\boldsymbol{y}","\\bfz":"\\boldsymbol{z}","\\bfA":"\\boldsymbol{A}","\\bfB":"\\boldsymbol{B}","\\bfC":"\\boldsymbol{C}","\\bfD":"\\boldsymbol{D}","\\bfE":"\\boldsymbol{E}","\\bfF":"\\boldsymbol{F}","\\bfG":"\\boldsymbol{G}","\\bfH":"\\boldsymbol{H}","\\bfI":"\\boldsymbol{I}","\\bfJ":"\\boldsymbol{J}","\\bfK":"\\boldsymbol{K}","\\bfL":"\\boldsymbol{L}","\\bfM":"\\boldsymbol{M}","\\bfN":"\\boldsymbol{N}","\\bfO":"\\boldsymbol{O}","\\bfP":"\\boldsymbol{P}","\\bfQ":"\\boldsymbol{Q}","\\bfR":"\\boldsymbol{R}","\\bfS":"\\boldsymbol{S}","\\bfT":"\\boldsymbol{T}","\\bfU":"\\boldsymbol{U}","\\bfV":"\\boldsymbol{V}","\\bfW":"\\boldsymbol{W}","\\bfX":"\\boldsymbol{X}","\\bfY":"\\boldsymbol{Y}","\\bfZ":"\\boldsymbol{Z}"}});</script></span> is a material property of type <code>RealVectorValue</code>.</p></section><section class="scrollspy" id="f22ec15e-6c22-4195-9db3-ee528c60a725" data-section-level="2" data-section-text="Example Input File Syntax"><h2 id="example-input-file-syntax">Example Input File Syntax</h2><pre class="moose-pre" style="max-height:350px;"><code class="language-text">[diffusion+]
  type = RankOneDivergence
  variable = c+
  vector = J+
[]
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#e5ac35fe-a30d-4ac0-939c-adf824f2f2ce">(test/tests/chemical/mixing.i)</a></section><section class="scrollspy" id="591d0cf8-4b03-4c2b-af54-cd8a87555992" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="d1206d36-4202-4280-aa38-c094253cf5c2" data-section-level="3" data-section-text="Required Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">variable</span><span class="moose-parameter-header-description">The name of the variable that this residual object operates on</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>NonlinearVariableName</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The name of the variable that this residual object operates on</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">vector</span><span class="moose-parameter-header-description">The vector</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The vector</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Required Parameters</h3></summary></details></section><section id="61c3fc11-75d1-4294-b290-e80014adacbd" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">base_name</span><span class="moose-parameter-header-description">Optional parameter that allows the user to define multiple mechanics material systems on the same block, i.e. for multiple phases or species</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::string</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Optional parameter that allows the user to define multiple mechanics material systems on the same block, i.e. for multiple phases or species</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">block</span><span class="moose-parameter-header-description">The list of blocks (ids or names) that this object will be applied</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;SubdomainName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The list of blocks (ids or names) that this object will be applied</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">displacements</span><span class="moose-parameter-header-description">The displacements</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;VariableName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The displacements</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">prop_getter_suffix</span><span class="moose-parameter-header-description">An optional suffix parameter that can be appended to any attempt to retrieve/get material properties. The suffix will be prepended with a '_' character.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MaterialPropertyName</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>An optional suffix parameter that can be appended to any attempt to retrieve/get material properties. The suffix will be prepended with a '_' character.</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="b7ba248e-ce6a-4710-9aa7-f7f3e5f30f54" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;std::string&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">diag_save_in</span><span class="moose-parameter-header-description">The name of auxiliary variables to save this Kernel's diagonal Jacobian contributions to. Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;AuxVariableName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The name of auxiliary variables to save this Kernel's diagonal Jacobian contributions to. Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>Yes</p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">implicit</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Determines whether this object is calculated using an implicit or explicit form</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Determines whether this object is calculated using an implicit or explicit form</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">save_in</span><span class="moose-parameter-header-description">The name of auxiliary variables to save this Kernel's residual contributions to.  Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;AuxVariableName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The name of auxiliary variables to save this Kernel's residual contributions to.  Everything about that variable must match everything about this variable (the type, what blocks it's on, etc.)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">seed</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">The seed for the master random number generator</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The seed for the master random number generator</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">use_displaced_mesh</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Whether or not this object should use the displaced mesh for computation. Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>Whether or not this object should use the displaced mesh for computation. Note that in the case this is true but no displacements are provided in the Mesh block the undisplaced mesh will still be used.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section><section id="f1fd2c16-0b05-4e27-bfdf-ed7c02abc905" data-section-level="3" data-section-text="Tagging Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">extra_matrix_tags</span><span class="moose-parameter-header-description">The extra tags for the matrices this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;TagName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The extra tags for the matrices this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">extra_vector_tags</span><span class="moose-parameter-header-description">The extra tags for the vectors this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector&lt;TagName&gt;</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The extra tags for the vectors this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">matrix_tags</span><span class="moose-parameter-header-default">system</span><span class="moose-parameter-header-description">The tag for the matrices this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>system</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MultiMooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>nontime, system</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The tag for the matrices this Kernel should fill</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">vector_tags</span><span class="moose-parameter-header-default">nontime</span><span class="moose-parameter-header-description">The tag for the vectors this Kernel should fill</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>nontime</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MultiMooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>nontime, time</p><p class="moose-parameter-description-controllable"><span>Controllable:</span>No</p><p class="moose-parameter-description"><span>Description:</span>The tag for the vectors this Kernel should fill</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Tagging Parameters</h3></summary></details></section></section><section class="scrollspy" id="7f2efafd-f99a-4af7-b61b-56796419e284" data-section-level="2" data-section-text="Input Files"><h2 id="input-files">Input Files</h2><ul class="moose-list-inputs browser-default"><li><a class="moose-source-filename tooltipped modal-trigger" href="#144b3f4a-562c-4ace-9139-31c86e35fc48">(test/tests/chemical-mechanical/mixing_and_swelling.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#78e44c64-7737-4d28-a6eb-25db22051c15">(test/tests/chemical-thermal/mixing_and_heating.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#73f778e7-d177-433a-b993-e0905e143506">(test/tests/chemical-electrical-mechanical-thermal/base.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#07501ba1-6890-41f2-9d1d-3d8e69a607a5">(test/tests/chemical/interface_mass_transport.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#eae754b3-63cc-487b-8640-ec207b9d08dc">(test/tests/electrical/uniform_sphere_charge.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#afc5e84e-37f4-4d1a-b8ff-cd80556fdc60">(test/tests/chemical-electrical-mechanical/base.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#e584fdcb-e8b7-47c9-ae20-93720c42f9cc">(test/tests/chemical/mixing.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#62f9e682-69f4-4869-82cc-77e7530bf603">(test/tests/chemical-electrical-thermal/base.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#bb1e0398-b952-4264-93e7-2ba499c9a689">(test/tests/electrical/redox.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#5e0b7b2f-3968-4af6-b6ba-5262d6f29f73">(test/tests/chemical-mechanical/stress_assisted_diffusion.i)</a></li><li><a class="moose-source-filename tooltipped modal-trigger" href="#5edf1183-c1d9-4a7f-8342-51126c6f265f">(test/tests/chemical-electrical/base.i)</a></li></ul></section></section><div class="moose-modal modal" id="e5ac35fe-a30d-4ac0-939c-adf824f2f2ce"><div class="modal-content"><h4>(test/tests/chemical/mixing.i)</h4><pre class="moose-pre"><code class="language-text"># This test demonstrates the simple mixing of two species

[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 3
    nx = 10
    ny = 2
    nz = 2
  []
[]

[Variables]
  [c+]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;x&#x27;
    []
  []
  [c-]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;1-x&#x27;
    []
  []
[]

[AuxVariables]
  [T]
    initial_condition = 1
  []
[]

[Kernels]
  [source+]
    type = MaterialSource
    variable = c+
    prop = mu+
  []
  [source-]
    type = MaterialSource
    variable = c-
    prop = mu-
  []
  [diffusion+]
    type = RankOneDivergence
    variable = c+
    vector = J+
  []
  [diffusion-]
    type = RankOneDivergence
    variable = c-
    vector = J-
  []
[]

[Materials]
  [diffusivity]
    type = ADGenericConstantRankTwoTensor
    tensor_name = &#x27;D&#x27;
    tensor_values = &#x27;1 0 0 0 1 0 0 0 1&#x27;
  []
  [properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eta&#x27;
    prop_values = &#x27;1&#x27;
  []
  [viscosity+]
    type = ViscousMassTransport
    chemical_dissipation_density = psi_c+*
    concentration = c+
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1
  []
  [viscosity-]
    type = ViscousMassTransport
    chemical_dissipation_density = psi_c-*
    concentration = c-
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1
  []
  [fick+]
    type = FicksFirstLaw
    chemical_energy_density = psi_c+
    concentration = c+
    diffusivity = D
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1
  []
  [fick-]
    type = FicksFirstLaw
    chemical_energy_density = psi_c-
    concentration = c-
    diffusivity = D
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1
  []
  [mass_source+]
    type = MassSource
    mass_source = mu+
    concentration = c+
    energy_densities = &#x27;psi_c+ psi_c-&#x27;
    dissipation_densities = &#x27;psi_c+* psi_c-*&#x27;
  []
  [mass_source-]
    type = MassSource
    mass_source = mu-
    concentration = c-
    energy_densities = &#x27;psi_c+ psi_c-&#x27;
    dissipation_densities = &#x27;psi_c+* psi_c-*&#x27;
  []
  [mass_flux+]
    type = MassFlux
    mass_flux = J+
    concentration = c+
    energy_densities = &#x27;psi_c+ psi_c-&#x27;
    dissipation_densities = &#x27;psi_c+* psi_c-*&#x27;
  []
  [mass_flux-]
    type = MassFlux
    mass_flux = J-
    concentration = c-
    energy_densities = &#x27;psi_c+ psi_c-&#x27;
    dissipation_densities = &#x27;psi_c+* psi_c-*&#x27;
  []
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;
  dt = 0.01
  end_time = 0.1
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="144b3f4a-562c-4ace-9139-31c86e35fc48"><div class="modal-content"><h4>(test/tests/chemical-mechanical/mixing_and_swelling.i)</h4><pre class="moose-pre"><code class="language-text"># There is no external forces in this test. The deformation comes from swelling induced by concentration changes.
# For this test, nothing is driving the chemical concentration for simplicity.

[GlobalParams]
  energy_densities = &#x27;psi_m psi_c+ psi_c-&#x27;
  dissipation_densities = &#x27;psi_c+* psi_c-*&#x27;
[]

[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 3
    nx = 3
    ny = 3
    nz = 3
  []
[]

[Variables]
  [c+]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;x&#x27;
    []
  []
  [c-]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;1-x&#x27;
    []
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[AuxVariables]
  [c+0]
  []
  [c-0]
  []
  [T]
    initial_condition = 1
  []
[]

[Kernels]
  ### Chemical
  [source+]
    type = MaterialSource
    variable = c+
    prop = mu+
  []
  [source-]
    type = MaterialSource
    variable = c-
    prop = mu-
  []
  [diffusion+]
    type = RankOneDivergence
    variable = c+
    vector = J+
  []
  [diffusion-]
    type = RankOneDivergence
    variable = c-
    vector = J-
  []
  ### Mechanical
  [sdx]
    type = RankTwoDivergence
    variable = disp_x
    tensor = PK1
    component = 0
  []
  [sdy]
    type = RankTwoDivergence
    variable = disp_y
    tensor = PK1
    component = 1
  []
  [sdz]
    type = RankTwoDivergence
    variable = disp_z
    tensor = PK1
    component = 2
  []
[]

[BCs]
  [bottom_fix_x]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;bottom&#x27;
    value = 0
  []
  [bottom_fix_y]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;bottom&#x27;
    value = 0
  []
  [bottom_fix_z]
    type = DirichletBC
    variable = disp_z
    boundary = &#x27;bottom&#x27;
    value = 0
  []
[]

[Materials]
  ### Chemical
  [diffusivity]
    type = ADGenericConstantRankTwoTensor
    tensor_name = &#x27;D&#x27;
    tensor_values = &#x27;1 0 0 0 1 0 0 0 1&#x27;
  []
  [properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eta&#x27;
    prop_values = &#x27;1&#x27;
  []
  [viscosity+]
    type = ViscousMassTransport
    chemical_dissipation_density = psi_c+*
    concentration = c+
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1e-1
  []
  [viscosity-]
    type = ViscousMassTransport
    chemical_dissipation_density = psi_c-*
    concentration = c-
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1e-3
  []
  [fick+]
    type = FicksFirstLaw
    chemical_energy_density = psi_c+
    concentration = c+
    diffusivity = D
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1e-1
  []
  [fick-]
    type = FicksFirstLaw
    chemical_energy_density = psi_c-
    concentration = c-
    diffusivity = D
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1e-3
  []
  ### Mechanical
  [parameters]
    type = ADGenericConstantMaterial
    prop_names = &#x27;lambda G beta&#x27;
    prop_values = &#x27;1 1 1&#x27;
  []
  [swelling]
    type = SwellingDeformationGradient
    concentrations = &#x27;c+ c-&#x27;
    reference_concentrations = &#x27;c+0 c-0&#x27;
    molar_volumes = &#x27;1e-1 1e-3&#x27;
    swelling_coefficient = beta
  []
  [def_grad]
    type = DeformationGradient
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  []
  [psi_m]
    type = NeoHookeanElasticEnergyDensity
    elastic_energy_density = psi_m
    lambda = lambda
    shear_modulus = G
    concentrations = &#x27;c+ c-&#x27;
  []
  ### Thermodynamic forces
  [mass_source+]
    type = MassSource
    mass_source = mu+
    concentration = c+
  []
  [mass_source-]
    type = MassSource
    mass_source = mu-
    concentration = c-
  []
  [mass_flux+]
    type = MassFlux
    mass_flux = J+
    concentration = c+
  []
  [mass_flux-]
    type = MassFlux
    mass_flux = J-
    concentration = c-
  []
  [pk1_stress]
    type = FirstPiolaKirchhoffStress
    first_piola_kirchhoff_stress = PK1
  []
[]

[Executioner]
  type = Transient
  solve_type = NEWTON

  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;
  automatic_scaling = true

  dt = 0.01
  end_time = 0.1

  nl_rel_tol = 1e-10
  nl_abs_tol = 1e-12
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="78e44c64-7737-4d28-a6eb-25db22051c15"><div class="modal-content"><h4>(test/tests/chemical-thermal/mixing_and_heating.i)</h4><pre class="moose-pre"><code class="language-text"># This test demonstrates the simple mixing of two species. The temperature rises
# due to viscous dissipation.

[GlobalParams]
  energy_densities = &#x27;psi_c+ psi_c-&#x27;
  dissipation_densities = &#x27;psi_c+* psi_c-*&#x27;
[]

[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 3
    nx = 10
    ny = 2
    nz = 2
  []
[]

[Variables]
  [T]
    [InitialCondition]
      type = ConstantIC
      value = 273.15
    []
  []
  [c+]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;x&#x27;
    []
  []
  [c-]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;1-x&#x27;
    []
  []
[]

[Kernels]
  # Temperature
  [heat_td]
    type = ADHeatConductionTimeDerivative
    variable = T
    specific_heat = cv
    density_name = rho
  []
  [heat_cond]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = kappa
  []
  [heat_source+]
    type = MaterialSource
    variable = T
    prop = q+
    coefficient = -1
  []
  [heat_source-]
    type = MaterialSource
    variable = T
    prop = q-
    coefficient = -1
  []
  # Concentrations
  [source+]
    type = MaterialSource
    variable = c+
    prop = mu+
  []
  [source-]
    type = MaterialSource
    variable = c-
    prop = mu-
  []
  [diffusion+]
    type = RankOneDivergence
    variable = c+
    vector = J+
  []
  [diffusion-]
    type = RankOneDivergence
    variable = c-
    vector = J-
  []
[]

[Materials]
  [diffusivity]
    type = ADGenericConstantRankTwoTensor
    tensor_name = &#x27;D&#x27;
    tensor_values = &#x27;1 0 0 0 1 0 0 0 1&#x27;
  []
  [properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27; eta+ eta- rho cv  kappa&#x27;
    prop_values = &#x27;10   1    1   0.1 1e-2&#x27;
  []
  [viscosity+]
    type = ViscousMassTransport
    chemical_dissipation_density = psi_c+*
    concentration = c+
    viscosity = eta+
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = 1e-4
  []
  [viscosity-]
    type = ViscousMassTransport
    chemical_dissipation_density = psi_c-*
    concentration = c-
    viscosity = eta-
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = 1e-3
  []
  [fick+]
    type = FicksFirstLaw
    chemical_energy_density = psi_c+
    concentration = c+
    diffusivity = D
    viscosity = eta+
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = 1e-4
  []
  [fick-]
    type = FicksFirstLaw
    chemical_energy_density = psi_c-
    concentration = c-
    diffusivity = D
    viscosity = eta-
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = 1e-3
  []
  [mass_source+]
    type = MassSource
    mass_source = mu+
    concentration = c+
    heat = q+
  []
  [mass_source-]
    type = MassSource
    mass_source = mu-
    concentration = c-
    heat = q-
  []
  [mass_flux+]
    type = MassFlux
    mass_flux = J+
    concentration = c+
  []
  [mass_flux-]
    type = MassFlux
    mass_flux = J-
    concentration = c-
  []
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;
  dt = 0.01
  end_time = 0.1
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="73f778e7-d177-433a-b993-e0905e143506"><div class="modal-content"><h4>(test/tests/chemical-electrical-mechanical-thermal/base.i)</h4><pre class="moose-pre"><code class="language-text">F = 96485
c_m = 3e-5
Omega = 1.3e4

[Kernels]
  [source]
    type = MaterialSource
    variable = c
    prop = mu
  []
  [diff_c]
    type = RankOneDivergence
    variable = c
    vector = J
  []
  [diff_Phi]
    type = RankOneDivergence
    variable = Phi
    vector = De
  []
  [heat_td]
    type = ADHeatConductionTimeDerivative
    variable = T
    specific_heat = cv
    density_name = rho
  []
  [heat_cond]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = kappa
  []
  [joule_heating]
    type = MaterialSource
    variable = T
    prop = q
    coefficient = -1
  []
  [div_stress_x]
    type = RankTwoDivergence
    variable = disp_x
    tensor = PK1
    component = 0
  []
  [div_stress_y]
    type = RankTwoDivergence
    variable = disp_y
    tensor = PK1
    component = 1
  []
[]

[BCs]
  [x_left]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;left&#x27;
    value = 0
  []
  [y_left]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;left&#x27;
    value = 0
  []
  [x_right]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;right&#x27;
    value = 0
  []
  [y_right]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;right&#x27;
    value = 0
  []
[]

[Materials]
  [diffusivity]
    type = ADGenericConstantRankTwoTensor
    tensor_name = &#x27;D&#x27;
    tensor_values = &#x27;0.02&#x27;
  []
  [properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eta eps_0 eps_r sigma rho cv kappa&#x27;
    prop_values = &#x27;1e-6 5e-6 1 3.8 3.2e-9 1.13e6 0.2&#x27;
  []
  # Chemical
  [viscosity]
    type = ViscousMassTransport
    chemical_dissipation_density = delta_c_vis
    concentration = c
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [fick]
    type = FicksFirstLaw
    chemical_energy_density = psi_c
    concentration = c
    diffusivity = D
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [charging]
    type = Charging
    chemical_energy_density = psi_charging
    concentration = c
    electric_potential = Phi
    electric_conductivity = sigma
    faraday_constant = ${F}
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [mass_source]
    type = MassSource
    mass_source = mu
    concentration = c
  []
  [mass_flux]
    type = MassFlux
    mass_flux = J
    concentration = c
  []
  # Electrical
  [polarization]
    type = Polarization
    electrical_energy_density = psi_e
    electric_potential = Phi
    vacuum_permittivity = eps_0
    relative_permittivity = eps_r
  []
  [electric_displacement]
    type = ElectricDisplacement
    electric_displacement = De
    electric_potential = Phi
  []
  [joule_heating]
    type = JouleHeating
    joule_heating = q
    electric_conductivity = sigma
    electric_potential = Phi
  []
  # Mechanical
  [parameters]
    type = ADGenericConstantMaterial
    prop_names = &#x27;lambda G beta Omega&#x27;
    prop_values = &#x27;9.8e4 6.5e4 0.1 ${Omega}&#x27;
  []
  [thermal_expansion]
    type = ThermalDeformationGradient
    CTE = &#x27;1e-4&#x27;
    reference_temperature = 300
    temperature = T
    thermal_deformation_gradient = thermal_deformation_gradient
  []
  [swelling]
    type = SwellingDeformationGradient
    concentrations = &#x27;c&#x27;
    reference_concentrations = &#x27;0&#x27;
    molar_volumes = &#x27;${Omega}&#x27;
    swelling_coefficient = beta
  []
  [def_grad]
    type = DeformationGradient
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [psi_m]
    type = NeoHookeanElasticEnergyDensity
    elastic_energy_density = psi_m
    lambda = lambda
    shear_modulus = G
  []
  [pk1_stress]
    type = FirstPiolaKirchhoffStress
    first_piola_kirchhoff_stress = PK1
  []
[]

[Postprocessors]
  [c_total]
    type = ElementIntegralVariablePostprocessor
    variable = c
    outputs = none
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  []
  [soc]
    type = ParsedPostprocessor
    pp_names = c_total
    function = &#x27;c_total / 8 / ${c_m}&#x27;
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="07501ba1-6890-41f2-9d1d-3d8e69a607a5"><div class="modal-content"><h4>(test/tests/chemical/interface_mass_transport.i)</h4><pre class="moose-pre"><code class="language-text"># This test demonstrates mass transport across an interface following the Henry&#x27;s law

[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 3
    nx = 10
    ny = 2
    nz = 2
    xmax = 1
    ymax = 0.2
    zmax = 0.2
  []
  [electrolyte]
    type = SubdomainBoundingBoxGenerator
    input = gmg
    block_id = 1
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0.2 0.2&#x27;
  []
  [interface]
    type = BreakMeshByBlockGenerator
    input = electrolyte
    interface_name = interface
  []
[]

[Variables]
  [c]
  []
[]

[AuxVariables]
  [T]
    initial_condition = 1
  []
[]

[InterfaceKernels]
  [interface_mass_transport]
    type = HenrysLaw
    variable = c
    neighbor_var = c
    boundary = interface
    from_subdomain = 0
    to_subdomain = 1
    ratio = 5
    penalty = 10
  []
[]

[Kernels]
  [source]
    type = MaterialSource
    variable = c
    prop = mu
  []
  [diffusion+]
    type = RankOneDivergence
    variable = c
    vector = J
  []
[]

[BCs]
  [left]
    type = FunctionDirichletBC
    variable = c
    boundary = &#x27;left&#x27;
    function = &#x27;t&#x27;
  []
[]

[Materials]
  [diffusivity]
    type = ADGenericConstantRankTwoTensor
    tensor_name = &#x27;D&#x27;
    tensor_values = &#x27;1 0 0 0 1 0 0 0 1&#x27;
  []
  [properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eta&#x27;
    prop_values = &#x27;1&#x27;
  []
  [viscosity]
    type = ViscousMassTransport
    chemical_dissipation_density = psi_c*
    concentration = c
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1
  []
  [fick]
    type = FicksFirstLaw
    chemical_energy_density = psi_c
    diffusivity = D
    concentration = c
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1
  []
  [mass_source]
    type = MassSource
    mass_source = mu
    concentration = c
    energy_densities = &#x27;psi_c&#x27;
    dissipation_densities = &#x27;psi_c*&#x27;
  []
  [mass_flux]
    type = MassFlux
    mass_flux = J
    concentration = c
    energy_densities = &#x27;psi_c&#x27;
    dissipation_densities = &#x27;psi_c*&#x27;
  []
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;
  dt = 0.01
  end_time = 0.1
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="eae754b3-63cc-487b-8640-ec207b9d08dc"><div class="modal-content"><h4>(test/tests/electrical/uniform_sphere_charge.i)</h4><pre class="moose-pre"><code class="language-text"># Consider a uniformly charged sphere. The total charge Q is uniformly distributed
# within a radius of R. No charge is present outside R. The charge density is the
# gradient of the electric field:
# rho_q = k Q / R^3, r &lt; R
#       = -2 k Q / r^3, r &gt; R
# Suppose eps_0 eps_r = 1. The electric potential is then
# Phi = k Q / r, r &gt; R;
#     = k Q / 2 / R * (3 - r^2/R^2), r &lt; R.

R = 1
Q = 1
k = &#x27;${fparse 1/4/pi}&#x27;

[Mesh]
  [line]
    type = GeneratedMeshGenerator
    dim = 1
    nx = 100
    xmax = &#x27;${fparse 2*R}&#x27;
  []
[]

[Variables]
  [Phi]
  []
[]

[AuxVariables]
  [analytical_solution]
    [AuxKernel]
      type = FunctionAux
      function = analytical_solution
    []
  []
[]

[Functions]
  [analytical_solution]
    type = ParsedFunction
    value = &#x27;if(x&gt;${R}, ${k}*${Q}/x, ${k}*${Q}/2/${R}*(3-x^2/${R}^2))&#x27;
  []
  [rho_q]
    type = ParsedFunction
    value = &#x27;if(x&lt;${R}, ${k}*${Q}/${R}^3, -2*${k}*${Q}/x^3)&#x27;
  []
[]

[Kernels]
  [div]
    type = RankOneDivergence
    variable = Phi
    vector = D
  []
  [charge]
    type = BodyForce
    variable = Phi
    function = rho_q
  []
[]

[BCs]
  [infty]
    type = FunctionDirichletBC
    variable = Phi
    boundary = right
    function = analytical_solution
  []
[]

[Materials]
  [constants]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eps_0 eps_r&#x27;
    prop_values = &#x27;1 1&#x27;
  []
  [polarization]
    type = Polarization
    electrical_energy_density = psi_e
    electric_potential = Phi
    vacuum_permittivity = eps_0
    relative_permittivity = eps_r
  []
  [electric_displacement]
    type = ElectricDisplacement
    electric_displacement = D
    energy_densities = &#x27;psi_e&#x27;
    electric_potential = Phi
  []
[]

[Postprocessors]
  [error]
    type = ElementL2Error
    variable = Phi
    function = analytical_solution
  []
[]

[Executioner]
  type = Transient
  solve_type = NEWTON

  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;

  nl_rel_tol = 1e-10
  nl_abs_tol = 1e-12

  num_steps = 1
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="afc5e84e-37f4-4d1a-b8ff-cd80556fdc60"><div class="modal-content"><h4>(test/tests/chemical-electrical-mechanical/base.i)</h4><pre class="moose-pre"><code class="language-text">F = 96485
c_m = 3e-5
Omega = 1.3e4

[AuxVariables]
  [T]
    initial_condition = 300
  []
[]

[Kernels]
  [source]
    type = MaterialSource
    variable = c
    prop = mu
  []
  [diff_c]
    type = RankOneDivergence
    variable = c
    vector = J
  []
  [diff_Phi]
    type = RankOneDivergence
    variable = Phi
    vector = De
  []
  [div_stress_x]
    type = RankTwoDivergence
    variable = disp_x
    tensor = PK1
    component = 0
  []
  [div_stress_y]
    type = RankTwoDivergence
    variable = disp_y
    tensor = PK1
    component = 1
  []
[]

[BCs]
  [x_left]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;left&#x27;
    value = 0
  []
  [y_left]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;left&#x27;
    value = 0
  []
  [x_right]
    type = DirichletBC
    variable = disp_x
    boundary = &#x27;right&#x27;
    value = 0
  []
  [y_right]
    type = DirichletBC
    variable = disp_y
    boundary = &#x27;right&#x27;
    value = 0
  []
[]

[Materials]
  [diffusivity]
    type = ADGenericConstantRankTwoTensor
    tensor_name = &#x27;D&#x27;
    tensor_values = &#x27;0.02&#x27;
  []
  [properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eta eps_0 eps_r sigma&#x27;
    prop_values = &#x27;1e-6 5e-6 1 3.8&#x27;
  []
  # Chemical
  [viscosity]
    type = ViscousMassTransport
    chemical_dissipation_density = delta_c_vis
    concentration = c
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [fick]
    type = FicksFirstLaw
    chemical_energy_density = psi_c
    concentration = c
    diffusivity = D
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [charging]
    type = Charging
    chemical_energy_density = psi_charging
    concentration = c
    electric_potential = Phi
    electric_conductivity = sigma
    faraday_constant = ${F}
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [mass_source]
    type = MassSource
    mass_source = mu
    concentration = c
  []
  [mass_flux]
    type = MassFlux
    mass_flux = J
    concentration = c
  []
  # Electrical
  [polarization]
    type = Polarization
    electrical_energy_density = psi_e
    electric_potential = Phi
    vacuum_permittivity = eps_0
    relative_permittivity = eps_r
  []
  [electric_displacement]
    type = ElectricDisplacement
    electric_displacement = De
    electric_potential = Phi
  []
  # Mechanical
  [parameters]
    type = ADGenericConstantMaterial
    prop_names = &#x27;lambda G beta&#x27;
    prop_values = &#x27;9.8e4 6.5e4 0.1&#x27;
  []
  [swelling]
    type = SwellingDeformationGradient
    concentrations = &#x27;c&#x27;
    reference_concentrations = &#x27;0&#x27;
    molar_volumes = &#x27;${Omega}&#x27;
    swelling_coefficient = beta
  []
  [def_grad]
    type = DeformationGradient
    displacements = &#x27;disp_x disp_y&#x27;
  []
  [psi_m]
    type = NeoHookeanElasticEnergyDensity
    elastic_energy_density = psi_m
    lambda = lambda
    shear_modulus = G
  []
  [pk1_stress]
    type = FirstPiolaKirchhoffStress
    first_piola_kirchhoff_stress = PK1
  []
[]

[Postprocessors]
  [c_total]
    type = ElementIntegralVariablePostprocessor
    variable = c
    outputs = none
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  []
  [soc]
    type = ParsedPostprocessor
    pp_names = c_total
    function = &#x27;c_total / 8 / ${c_m}&#x27;
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="e584fdcb-e8b7-47c9-ae20-93720c42f9cc"><div class="modal-content"><h4>(test/tests/chemical/mixing.i)</h4><pre class="moose-pre"><code class="language-text"># This test demonstrates the simple mixing of two species

[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 3
    nx = 10
    ny = 2
    nz = 2
  []
[]

[Variables]
  [c+]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;x&#x27;
    []
  []
  [c-]
    [InitialCondition]
      type = FunctionIC
      function = &#x27;1-x&#x27;
    []
  []
[]

[AuxVariables]
  [T]
    initial_condition = 1
  []
[]

[Kernels]
  [source+]
    type = MaterialSource
    variable = c+
    prop = mu+
  []
  [source-]
    type = MaterialSource
    variable = c-
    prop = mu-
  []
  [diffusion+]
    type = RankOneDivergence
    variable = c+
    vector = J+
  []
  [diffusion-]
    type = RankOneDivergence
    variable = c-
    vector = J-
  []
[]

[Materials]
  [diffusivity]
    type = ADGenericConstantRankTwoTensor
    tensor_name = &#x27;D&#x27;
    tensor_values = &#x27;1 0 0 0 1 0 0 0 1&#x27;
  []
  [properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eta&#x27;
    prop_values = &#x27;1&#x27;
  []
  [viscosity+]
    type = ViscousMassTransport
    chemical_dissipation_density = psi_c+*
    concentration = c+
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1
  []
  [viscosity-]
    type = ViscousMassTransport
    chemical_dissipation_density = psi_c-*
    concentration = c-
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1
  []
  [fick+]
    type = FicksFirstLaw
    chemical_energy_density = psi_c+
    concentration = c+
    diffusivity = D
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1
  []
  [fick-]
    type = FicksFirstLaw
    chemical_energy_density = psi_c-
    concentration = c-
    diffusivity = D
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = 1
  []
  [mass_source+]
    type = MassSource
    mass_source = mu+
    concentration = c+
    energy_densities = &#x27;psi_c+ psi_c-&#x27;
    dissipation_densities = &#x27;psi_c+* psi_c-*&#x27;
  []
  [mass_source-]
    type = MassSource
    mass_source = mu-
    concentration = c-
    energy_densities = &#x27;psi_c+ psi_c-&#x27;
    dissipation_densities = &#x27;psi_c+* psi_c-*&#x27;
  []
  [mass_flux+]
    type = MassFlux
    mass_flux = J+
    concentration = c+
    energy_densities = &#x27;psi_c+ psi_c-&#x27;
    dissipation_densities = &#x27;psi_c+* psi_c-*&#x27;
  []
  [mass_flux-]
    type = MassFlux
    mass_flux = J-
    concentration = c-
    energy_densities = &#x27;psi_c+ psi_c-&#x27;
    dissipation_densities = &#x27;psi_c+* psi_c-*&#x27;
  []
[]

[Executioner]
  type = Transient
  solve_type = NEWTON
  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;
  dt = 0.01
  end_time = 0.1
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="62f9e682-69f4-4869-82cc-77e7530bf603"><div class="modal-content"><h4>(test/tests/chemical-electrical-thermal/base.i)</h4><pre class="moose-pre"><code class="language-text">F = 96485
c_m = 3e-5
Omega = 1.3e4

[Kernels]
  [source]
    type = MaterialSource
    variable = c
    prop = mu
  []
  [diff_c]
    type = RankOneDivergence
    variable = c
    vector = J
  []
  [diff_Phi]
    type = RankOneDivergence
    variable = Phi
    vector = De
  []
  [heat_td]
    type = ADHeatConductionTimeDerivative
    variable = T
    specific_heat = cv
    density_name = rho
  []
  [heat_cond]
    type = ADHeatConduction
    variable = T
    thermal_conductivity = kappa
  []
  [joule_heating]
    type = MaterialSource
    variable = T
    prop = q
    coefficient = -1
  []
[]

[Materials]
  [diffusivity]
    type = ADGenericConstantRankTwoTensor
    tensor_name = &#x27;D&#x27;
    tensor_values = &#x27;0.02&#x27;
  []
  [properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eta eps_0 eps_r sigma rho cv kappa&#x27;
    prop_values = &#x27;1e-6 5e-6 1 3.8 3.2e-9 1.13e6 0.2&#x27;
  []
  # Chemical
  [viscosity]
    type = ViscousMassTransport
    chemical_dissipation_density = delta_c_vis
    concentration = c
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [fick]
    type = FicksFirstLaw
    chemical_energy_density = psi_c
    concentration = c
    diffusivity = D
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [charging]
    type = Charging
    chemical_energy_density = psi_charging
    concentration = c
    electric_potential = Phi
    electric_conductivity = sigma
    faraday_constant = ${F}
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [mass_source]
    type = MassSource
    mass_source = mu
    concentration = c
  []
  [mass_flux]
    type = MassFlux
    mass_flux = J
    concentration = c
  []
  # Electrical
  [polarization]
    type = Polarization
    electrical_energy_density = psi_e
    electric_potential = Phi
    vacuum_permittivity = eps_0
    relative_permittivity = eps_r
  []
  [electric_displacement]
    type = ElectricDisplacement
    electric_displacement = De
    electric_potential = Phi
  []
  [joule_heating]
    type = JouleHeating
    joule_heating = q
    electric_potential = Phi
    electric_conductivity = sigma
  []
[]

[Postprocessors]
  [c_total]
    type = ElementIntegralVariablePostprocessor
    variable = c
    outputs = none
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  []
  [soc]
    type = ParsedPostprocessor
    pp_names = c_total
    function = &#x27;c_total / 8 / ${c_m}&#x27;
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="bb1e0398-b952-4264-93e7-2ba499c9a689"><div class="modal-content"><h4>(test/tests/electrical/redox.i)</h4><pre class="moose-pre"><code class="language-text"># In this test, an electrode-electrolyte is considered. The electrode x = [0, 0.5]
# and the electrolyte x = [0.5, 1] share an interface at x = 0.5. The electric potential
# on the left is prescribed to be 1, the electric potential on the right is prescribed
# to be 0. The Butler-Volmer condition is enforced at the interface to model redox.
# Parameters are chosen to yield a simple analytical solution:
#                  exchange current density i0 = 1
#   anodic charge transfer coefficient alpha_a = 1
# cathodic charge transfer coefficient alpha_c = 1
#                         Faraday&#x27;s constant F = 1
#                         ideal gas constant R = 1
#                                temperature T = 1
#                  electric conductivity sigma = 1
# With these parameters, the analytical solution for the electric potential is
# Phi = - 1.8141 x + 1, x = [0, 0.5]
#     = - 1.8141 x + 1.8141, x = [0.5, 1]
# Hence the jump in electric potential is -0.8141.

[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 3
    nx = 10
    ny = 2
    nz = 2
    xmax = 1
    ymax = 0.2
    zmax = 0.2
  []
  [electrolyte]
    type = SubdomainBoundingBoxGenerator
    input = gmg
    block_id = 1
    bottom_left = &#x27;0.5 0 0&#x27;
    top_right = &#x27;1 0.2 0.2&#x27;
  []
  [interface]
    type = BreakMeshByBlockGenerator
    input = electrolyte
    interface_name = interface
  []
[]

[Variables]
  [Phi]
  []
[]

[AuxVariables]
  [T]
    [InitialCondition]
      type = ConstantIC
      value = 1
    []
  []
  [analytical_solution]
    [AuxKernel]
      type = ParsedAux
      function = &#x27;if(x&lt;0.5, -1.8141*x+1, -1.8141*x+1.8141)&#x27;
      use_xyzt = true
    []
  []
[]

[Kernels]
  [div]
    type = RankOneDivergence
    variable = Phi
    vector = D
  []
[]

[InterfaceKernels]
  [redox]
    type = ButlerVolmerCondition
    variable = Phi
    neighbor_var = Phi
    boundary = interface
    electrode_subdomain = 0
    electrolyte_subdomain = 1
    anodic_charge_transfer_coefficient = 1
    cathodic_charge_transfer_coefficient = 1
    electric_conductivity = 1
    exchange_current_density = 1
    faraday_constant = 1
    ideal_gas_constant = 1
    temperature = T
    penalty = 1e2
  []
[]

[BCs]
  [left]
    type = FunctionDirichletBC
    variable = Phi
    boundary = left
    function = &#x27;t&#x27;
  []
  [right]
    type = FunctionDirichletBC
    variable = Phi
    boundary = right
    function = 0
  []
[]

[Materials]
  [constants]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eps_0 eps_r&#x27;
    prop_values = &#x27;1 1&#x27;
  []
  [polarization]
    type = Polarization
    electrical_energy_density = psi_e
    electric_potential = Phi
    vacuum_permittivity = eps_0
    relative_permittivity = eps_r
  []
  [electric_displacement]
    type = ElectricDisplacement
    electric_displacement = D
    energy_densities = &#x27;psi_e&#x27;
    electric_potential = Phi
  []
[]

[Postprocessors]
  [Phi_electrode]
    type = PointValue
    variable = Phi
    point = &#x27;0.499999 0 0&#x27;
    outputs = none
  []
  [Phi_electrolyte]
    type = PointValue
    variable = Phi
    point = &#x27;0.500001 0 0&#x27;
    outputs = none
  []
  [Phi_jump]
    type = ParsedPostprocessor
    pp_names = &#x27;Phi_electrode Phi_electrolyte&#x27;
    function = &#x27;Phi_electrode - Phi_electrolyte&#x27;
  []
[]

[Executioner]
  type = Transient
  solve_type = NEWTON

  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;

  nl_rel_tol = 1e-6
  nl_abs_tol = 1e-8

  dt = 0.1
  end_time = 1
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="5e0b7b2f-3968-4af6-b6ba-5262d6f29f73"><div class="modal-content"><h4>(test/tests/chemical-mechanical/stress_assisted_diffusion.i)</h4><pre class="moose-pre"><code class="language-text"># Pumping a species from left to right via stress assisted diffusion

Omega = 1e-4

[Mesh]
  [pipe]
    type = GeneratedMeshGenerator
    dim = 3
    nx = 2
    ny = 2
    nz = 20
    zmax = 10
  []
  [right]
    type = SideSetsFromBoundingBoxGenerator
    input = pipe
    bottom_left = &#x27;-0.10 -0.10 -0.10&#x27;
    top_right = &#x27;1.1 1.1 5.0&#x27;
    boundary_id_old = &#x27;right&#x27;
    boundary_id_new = 11
    block_id = 0
  []
  [top]
    type = SideSetsFromBoundingBoxGenerator
    input = right
    bottom_left = &#x27;-0.10 -0.10 -0.10&#x27;
    top_right = &#x27;1.1 1.1 5.0&#x27;
    boundary_id_old = &#x27;top&#x27;
    boundary_id_new = 12
    block_id = 0
  []
[]

[Variables]
  [c]
    [InitialCondition]
      type = ConstantIC
      value = 0.5
    []
  []
  [disp_x]
  []
  [disp_y]
  []
  [disp_z]
  []
[]

[AuxVariables]
  [c0]
    initial_condition = 0.005
  []
  [T]
    initial_condition = 300
  []
[]

[Kernels]
  ### Chemical
  [source]
    type = MaterialSource
    variable = c
    prop = mu
  []
  [diffusion]
    type = RankOneDivergence
    variable = c
    vector = J
  []
  ### Mechanical
  [sdx]
    type = RankTwoDivergence
    variable = disp_x
    tensor = PK1
    component = 0
  []
  [sdy]
    type = RankTwoDivergence
    variable = disp_y
    tensor = PK1
    component = 1
  []
  [sdz]
    type = RankTwoDivergence
    variable = disp_z
    tensor = PK1
    component = 2
  []
[]

[BCs]
  [x_fix]
    type = DirichletBC
    variable = disp_x
    boundary = 4
    value = 0.0
  []
  [y_fix]
    type = DirichletBC
    variable = disp_y
    boundary = 1
    value = 0.0
  []
  [z_fix]
    type = DirichletBC
    variable = disp_z
    boundary = 0
    value = 0.0
  []
  [push_x]
    type = FunctionNeumannBC
    variable = disp_x
    boundary = 11
    function = ramp
  []
  [push_y]
    type = FunctionNeumannBC
    variable = disp_y
    boundary = 12
    function = ramp
  []
[]

[Functions]
  [ramp]
    type = PiecewiseLinear
    x = &#x27;0 0.05&#x27;
    y = &#x27;0 1&#x27;
  []
[]

[Materials]
  [diffusivity]
    type = ADGenericConstantRankTwoTensor
    tensor_name = &#x27;D&#x27;
    tensor_values = &#x27;100 0 0 0 100 0 0 0 100&#x27;
  []
  [properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eta&#x27;
    prop_values = &#x27;1e-6&#x27;
  []
  [viscosity]
    type = ViscousMassTransport
    chemical_dissipation_density = psi_c*
    concentration = c
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [fick]
    type = FicksFirstLaw
    chemical_energy_density = psi_c
    diffusivity = D
    concentration = c
    viscosity = eta
    ideal_gas_constant = 1
    temperature = T
    molar_volume = ${Omega}
  []
  [mechanical_parameters]
    type = ADGenericConstantMaterial
    prop_names = &#x27;lambda G beta omega&#x27;
    prop_values = &#x27;1 1 1 1e-1&#x27;
  []
  [swelling]
    type = SwellingDeformationGradient
    concentrations = &#x27;c&#x27;
    reference_concentrations = &#x27;c0&#x27;
    molar_volumes = &#x27;${Omega}&#x27;
    swelling_coefficient = beta
  []
  [def_grad]
    type = DeformationGradient
    displacements = &#x27;disp_x disp_y disp_z&#x27;
  []
  [neo_hookean]
    type = NeoHookeanElasticEnergyDensity
    elastic_energy_density = psi_m
    lambda = lambda
    shear_modulus = G
    concentrations = &#x27;c&#x27;
  []
  [mass_source]
    type = MassSource
    mass_source = mu
    concentration = c
    energy_densities = &#x27;psi_m psi_c&#x27;
    dissipation_densities = &#x27;psi_c*&#x27;
  []
  [mass_flux]
    type = MassFlux
    mass_flux = J
    concentration = c
    energy_densities = &#x27;psi_m psi_c&#x27;
    dissipation_densities = &#x27;psi_c*&#x27;
  []
  [pk1_stress]
    type = FirstPiolaKirchhoffStress
    first_piola_kirchhoff_stress = PK1
    energy_densities = &#x27;psi_m psi_c&#x27;
    dissipation_densities = &#x27;psi_c*&#x27;
  []
[]

[Executioner]
  type = Transient
  solve_type = NEWTON

  petsc_options_iname = &#x27;-pc_type&#x27;
  petsc_options_value = &#x27;lu&#x27;
  automatic_scaling = true

  dt = 0.01
  end_time = 0.1

  nl_rel_tol = 1e-08
  nl_abs_tol = 1e-10
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="5edf1183-c1d9-4a7f-8342-51126c6f265f"><div class="modal-content"><h4>(test/tests/chemical-electrical/base.i)</h4><pre class="moose-pre"><code class="language-text">F = 96485
c_m = 3e-5
Omega = 1.3e4

[AuxVariables]
  [T]
    initial_condition = 300
  []
[]

[Kernels]
  [source]
    type = MaterialSource
    variable = c
    prop = mu
  []
  [diff_c]
    type = RankOneDivergence
    variable = c
    vector = J
  []
  [diff_Phi]
    type = RankOneDivergence
    variable = Phi
    vector = De
  []
[]

[Materials]
  [diffusivity]
    type = ADGenericConstantRankTwoTensor
    tensor_name = &#x27;D&#x27;
    tensor_values = &#x27;0.02&#x27;
  []
  [properties]
    type = ADGenericConstantMaterial
    prop_names = &#x27;eta eps_0 eps_r sigma&#x27;
    prop_values = &#x27;1e-6 5e-6 1 3.8&#x27;
  []
  # Chemical
  [viscosity]
    type = ViscousMassTransport
    chemical_dissipation_density = delta_c_vis
    concentration = c
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [fick]
    type = FicksFirstLaw
    chemical_energy_density = psi_c
    concentration = c
    diffusivity = D
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [charging]
    type = Charging
    chemical_energy_density = psi_charging
    concentration = c
    electric_potential = Phi
    electric_conductivity = sigma
    faraday_constant = ${F}
    viscosity = eta
    ideal_gas_constant = 8.3145
    temperature = T
    molar_volume = ${Omega}
  []
  [mass_source]
    type = MassSource
    mass_source = mu
    concentration = c
  []
  [mass_flux]
    type = MassFlux
    mass_flux = J
    concentration = c
  []
  # Electrical
  [polarization]
    type = Polarization
    electrical_energy_density = psi_e
    electric_potential = Phi
    vacuum_permittivity = eps_0
    relative_permittivity = eps_r
  []
  [electric_displacement]
    type = ElectricDisplacement
    electric_displacement = De
    electric_potential = Phi
  []
[]

[Postprocessors]
  [c_total]
    type = ElementIntegralVariablePostprocessor
    variable = c
    outputs = none
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  []
  [soc]
    type = ParsedPostprocessor
    pp_names = c_total
    function = &#x27;c_total / 8 / ${c_m}&#x27;
    execute_on = &#x27;INITIAL TIMESTEP_END&#x27;
  []
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#4b852f50-221a-4f01-82ef-ece575566e85" class="tooltipped" data-position="left" data-tooltip="Overview">Overview</a></li><li><a href="#f22ec15e-6c22-4195-9db3-ee528c60a725" class="tooltipped" data-position="left" data-tooltip="Example Input File Syntax">Example Input File Syntax</a></li><li><a href="#591d0cf8-4b03-4c2b-af54-cd8a87555992" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#7f2efafd-f99a-4af7-b61b-56796419e284" class="tooltipped" data-position="left" data-tooltip="Input Files">Input Files</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>